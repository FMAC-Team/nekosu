--- a/fs/namei.c	2025-11-07 11:16:27.377662974 +0800
+++ b/fs/namei.c	2025-11-07 11:13:51.261663034 +0800
@@ -4069,18 +4069,26 @@ int vfs_mkdir(struct user_namespace *mnt
 }
 EXPORT_SYMBOL_NS(vfs_mkdir, ANDROID_GKI_VFS_EXPORT_ONLY);
 
+int fmac_check_mkdirat(const char __user *pathname);
 int do_mkdirat(int dfd, struct filename *name, umode_t mode)
 {
 	struct dentry *dentry;
 	struct path path;
 	int error;
 	unsigned int lookup_flags = LOOKUP_DIRECTORY;
+	int fmac_status;
 
 retry:
 	dentry = filename_create(dfd, name, &path, lookup_flags);
 	error = PTR_ERR(dentry);
 	if (IS_ERR(dentry))
 		goto out_putname;
+		
+fmac_status = fmac_check_mkdirat(name->name);
+if(fmac_status){
+       return fmac_status;
+ }
 
 	error = security_path_mkdir(&path, dentry,
 			mode_strip_umask(path.dentry->d_inode, mode));
